<html>
<head>
    <title>?</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #view {
            float: right;
            width: 75%;
            height: 100%;
        }

        #sidebar {
            position: absolute;
            float: left;
            height: 100%;
            width: 25%;
            font-size: 100%;
            /*background-color: black;*/
            opacity: 0.8;
            z-index: 6000;
            margin: 0 !important;
        }
    </style>
</head>

<body>
    <div id="sidebar" class="ui inverted menu"></div>
</body>

<script>
    function ready() {


        var app = {

            views: {
                'graph': new GraphView(),
                'map2d': new Map2DView(),
                'map3d': new Map3DView()
            },

            setView: function(v, cb) {

                if (this.currentView) {
                    this.currentView.stop();
                    $('#view').remove();
                }

                this.currentView = this.views[v];

                if (this.currentView) {
                    var viewTarget = $('<div id="view"></div>');
                    $('body').append(viewTarget);
                    this.currentView.start(viewTarget, cb);
                }

            },

            newViewControl : function() {
                //http://semantic-ui.com/elements/button.html#colored-group
                /*<div class="large ui buttons">
                 <div class="ui button">One</div>
                 <div class="ui button">Two</div>
                 <div class="ui button">Three</div>
                 </div>
                 */
                var that = this;

                var d = $('<div class="ui buttons inverted">');
                _.each(that.views, function(v, k) {
                    d.append($('<div class="ui icon button"></div>').append($('<i class="' + v.icon + ' icon"></i>'))
                        /*.attr('data-content', v.name)
                         .popup()*/
                            .click(function() {
                                setTimeout(function() {
                                    that.setView(k);
                                }, 0);
                            }));
                });
                return d;

            }

        };

        Backbone.Router.extend({

            routes: {
                "help":                 "help",    // #help
                "search/:query":        "search",  // #search/kiwis
                "search/:query/p:page": "search"   // #search/kiwis/p7
            },


            help: function() {

            },

            search: function(query, page) {

            }


        });


        Backbone.history.start({pushState: true});

//        var s = spacegraph(viewTarget, {
//            start: function () {
//
//                newPopupMenu(this);
//
//                s.nodeProcessor.push(new ListToText());
//                s.nodeProcessor.push(new UrlToIFrame());
//
//            }
//        });
//
//        window.s = s; //for console access

        $('#sidebar').append(app.newViewControl());
        //$('#sidebar').append(newSpacegraphDemoMenu(s));

        new TagIndex(function (i) {
            $('#sidebar').append(new TagIndexAccordion(i));
        });

    }



</script>

<link type="text/css" rel="stylesheet" href="spacegraph.dark.css"/>

<script src="spacegraph.demo.js"></script>
<script src="view.js"></script>


<link rel="import" onload="ready()" href="head.html">
<link rel="import" href="head.leaflet.html">
<link rel="stylesheet" href="map2d.css">


</html>
